var FirebasePassportLogin=function(e,t,o){var r=this;r._ref=e,r._tokenPath="oAuthLogin",r._oAuthServerURL=o,r._oAuthServerWindow="width=1024, height=650",r._callback=t,r._ready=!0,r._initializePassportLogin=function(e){var t=[r._tokenPath,e].join("/"),o=r._ref.child(t);o.on("value",function(e){var t=e.val();t&&(o.remove(),o.off(),r._oAuthWindow.close(),r._ref.unauth(),r._setToken(t))});var n=r._oAuthServerURL+r._provider+"?oAuthTokenPath="+t;r._oAuthWindow.location=n},r._setToken=function(e){e&&r._ref.authWithCustomToken(e,function(t){t&&"EXPIRED_TOKEN"==t.code?(cookie.set("passportSession",""),r._callback(t)):r._ref.child("oAuthUsers").child(e.replace(/\./g,"")).once("value",function(t){var o=t.val();o&&(cookie.set("passportSession",e),o[o.provider]=JSON.parse(o.thirdPartyUserData),o.thirdPartyUserData=void 0,r._callback(null,o))})})},r._log=function(e){console.log&&console.log("FirebasePassportLogin: "+e)},r.login=function(e){r._oAuthWindow=window.open(r._oAuthServerURL+"/loading","",r._oAuthServerWindow),r._ref.getAuth()&&r.logout(),r._provider=e,r._ref.authAnonymously(function(e,t){if(e)r._log("Anonymous login failed. Make sure Anonymous login is enabled in your Firebase");else{var o=t.auth;o&&r._initializePassportLogin(o.uid)}},{remember:"default"})},r.logout=function(){var e=cookie.get("passportSession");e&&r._ref.child("oAuthUsers").child(e.replace(/\./g,"")).remove(),r._ref.unauth(),cookie.set("passportSession",""),r._callback(null,null)},setTimeout(function(){r._setToken(cookie.get("passportSession"))}),!function(e,t){var o=function(){return o.get.apply(o,arguments)},r=o.utils={isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isPlainObject:function(e){return!!e&&"[object Object]"===Object.prototype.toString.call(e)},toArray:function(e){return Array.prototype.slice.call(e)},getKeys:Object.keys||function(e){var t=[],o="";for(o in e)e.hasOwnProperty(o)&&t.push(o);return t},escape:function(e){return String(e).replace(/[,;"\\=\s%]/g,function(e){return encodeURIComponent(e)})},retrieve:function(e,t){return null==e?t:e}};o.defaults={},o.expiresMultiplier=86400,o.set=function(o,n,i){if(r.isPlainObject(o))for(var a in o)o.hasOwnProperty(a)&&this.set(a,o[a],n);else{i=r.isPlainObject(i)?i:{expires:i};var s=i.expires!==t?i.expires:this.defaults.expires||"",u=typeof s;"string"===u&&""!==s?s=new Date(s):"number"===u&&(s=new Date(+new Date+1e3*this.expiresMultiplier*s)),""!==s&&"toGMTString"in s&&(s=";expires="+s.toGMTString());var c=i.path||this.defaults.path;c=c?";path="+c:"";var l=i.domain||this.defaults.domain;l=l?";domain="+l:"";var f=i.secure||this.defaults.secure?";secure":"";e.cookie=r.escape(o)+"="+r.escape(n)+s+c+l+f}return this},o.remove=function(e){e=r.isArray(e)?e:r.toArray(arguments);for(var t=0,o=e.length;o>t;t++)this.set(e[t],"",-1);return this},o.empty=function(){return this.remove(r.getKeys(this.all()))},o.get=function(e,o){o=o||t;var n=this.all();if(r.isArray(e)){for(var i={},a=0,s=e.length;s>a;a++){var u=e[a];i[u]=r.retrieve(n[u],o)}return i}return r.retrieve(n[e],o)},o.all=function(){if(""===e.cookie)return{};for(var t=e.cookie.split("; "),o={},r=0,n=t.length;n>r;r++){var i=t[r].split("=");o[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return o},o.enabled=function(){if(navigator.cookieEnabled)return!0;var e="_"===o.set("_","_").get("_");return o.remove("_"),e},"function"==typeof define&&define.amd?define(function(){return o}):"undefined"!=typeof exports?exports.cookie=o:window.cookie=o}(document)};